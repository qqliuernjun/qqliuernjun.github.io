{"title":"vue-axios","date":"2019-01-24T10:02:16.000Z","slug":"vue-axios","tags":["vue"],"categories":["vue"],"updated":"2019-01-26T06:33:23.746Z","content":"<blockquote>\n<p>对于一些页面的访问权限配置,可在const.js中配置黑名单与白名单,通过在导航守卫中获取<code>to</code>,<code>form</code>等一些信息,从而对页面权限进行设置</p>\n</blockquote>\n<h2 id=\"post与get请求方式的差异\"><a href=\"#post与get请求方式的差异\" class=\"headerlink\" title=\"post与get请求方式的差异\"></a>post与get请求方式的差异</h2><p>参数的传递方式不一样,get请求的入参是{params:{}},post请求的入参是{data:{}},post的请求的data可以省略,而params不能<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.get(&apos;/user&apos;, &#123;params: &#123;ID: 12345&#125;&#125;)</span><br><span class=\"line\">  .then(function (response) &#123;</span><br><span class=\"line\">    console.log(response);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(function (error) &#123;</span><br><span class=\"line\">    console.log(error);</span><br><span class=\"line\">  &#125;);</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.post(&apos;/user&apos;,&#123;ID: 12345&#125;)</span><br><span class=\"line\">  .then(function (response) &#123;</span><br><span class=\"line\">    console.log(response);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(function (error) &#123;</span><br><span class=\"line\">    console.log(error);</span><br><span class=\"line\">  &#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"实现一些拦截的操作\"><a href=\"#实现一些拦截的操作\" class=\"headerlink\" title=\"实现一些拦截的操作\"></a>实现一些拦截的操作</h2><h3 id=\"路由上的拦截\"><a href=\"#路由上的拦截\" class=\"headerlink\" title=\"路由上的拦截\"></a>路由上的拦截</h3><ul>\n<li>可以再路由上写上自定义的参数,通过在导航守卫中对参数的判断来实现是否需要拦截以及其它的操作<br><img src=\"/2019/01/24/vue-axios/router1.png\" alt=\"你想要输入的替代文字\"><br><img src=\"/2019/01/24/vue-axios/router2.png\" alt=\"你想要输入的替代文字\"></li>\n</ul>\n<h3 id=\"axios拦截\"><a href=\"#axios拦截\" class=\"headerlink\" title=\"axios拦截\"></a>axios拦截</h3><ol>\n<li><p>请求拦截器</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.interceptors.request.use(</span><br><span class=\"line\">    config =&gt; &#123;</span><br><span class=\"line\">        可以对axios中get或者post请求的请求头做一些配置</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    err =&gt; &#123;</span><br><span class=\"line\">        return Promise.reject(err);</span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>响应拦截器</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.interceptors.response.use(</span><br><span class=\"line\">    response =&gt; &#123;</span><br><span class=\"line\">        return response;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    error =&gt; &#123;</span><br><span class=\"line\">        if (error.response) &#123;</span><br><span class=\"line\">            switch (error.response.status) &#123;</span><br><span class=\"line\">                case 401:</span><br><span class=\"line\">                    // 返回 401 清除token信息并跳转到登录页面</span><br><span class=\"line\">                    store.commit(types.LOGOUT);</span><br><span class=\"line\">                    router.replace(&#123;</span><br><span class=\"line\">                        path: &apos;login&apos;,</span><br><span class=\"line\">                        query: &#123;redirect: router.currentRoute.fullPath&#125;</span><br><span class=\"line\">                    &#125;)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return Promise.reject(error.response.data)   // 返回接口返回的错误信息</span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","prev":{"title":"vue 后记","slug":"vue-2"},"next":{"title":"vue 前序","slug":"vue"},"link":"http://yoursite.com/post/vue-axios/","toc":[{"title":"post与get请求方式的差异","id":"post与get请求方式的差异","index":"1"},{"title":"实现一些拦截的操作","id":"实现一些拦截的操作","index":"2","children":[{"title":"路由上的拦截","id":"路由上的拦截","index":"2.1"},{"title":"axios拦截","id":"axios拦截","index":"2.2"}]}]}